---
description: New prompt created from chat session
tools: ['edit', 'runNotebooks', 'search', 'new', 'runCommands', 'runTasks', 'next-devtools/*', 'chrome-devtools/*', 'Postgres(LOCAL-supabase)/*', 'supabase/apply_migration', 'supabase/confirm_cost', 'supabase/deploy_edge_function', 'supabase/execute_sql', 'supabase/generate_typescript_types', 'supabase/get_advisors', 'supabase/get_anon_key', 'supabase/get_edge_function', 'supabase/get_logs', 'supabase/list_migrations', 'supabase/list_tables', 'supabase/search_docs', 'vscode/get_terminal_output', 'shadcn-ui/*', 'shadcn/*', 'serena/*', 'playwright/browser_navigate', 'playwright/browser_resize', 'playwright/browser_select_option', 'calil-library-mcp/*', 'context7/*', 'sequentialthinking/*', 'executePrompt', 'usages', 'vscodeAPI', 'think', 'problems', 'changes', 'testFailure', 'openSimpleBrowser', 'fetch', 'githubRepo', 'extensions', 'todos', 'runTests']
model: GPT-5-Codex (Preview) (copilot)
---
<user>
0020 個別機能 大 -01要件定義書 -02設計書 -03テスト計画書\0012-01-アクセス権限要件定義書.md と 0020 個別機能 大 -01要件定義書 -02設計書 -03テスト計画書\0012-02-アクセス権限設計書.md この要件定義書と設計書両方を書く意味はありますか？ コードをAIに書いてもらいたいのですがこれでいいのでしょうか？
</user>
<assistant>
要件定義書と設計書は役割が違いますが、どちらも揃っているとアクセス権限のような複雑機能ではメリットが大きいです。
- 要件定義書（0012-01）は「何を満たすべきか」を利用者視点で固定化し、変更管理の基準になります。AIに指示する際も、このドキュメントをそのまま制約や受入基準として渡せます。
- 設計書（0012-02）は要件を「どう実現するか」に落とし込み、データ構造やロジック、フローを明文化します。AIにコードを依頼するときは、この設計の断片をプロンプトに差し込みながら段階的に実装を生成するとブレが出にくく、テスト設計やレビュー時にも根拠として使えます。
- どちらか一方だけだと変更時の影響箇所が追いにくく、AIに頼む際のプロンプトも抽象的になりがちです。今の構成なら「要件 → 設計 → 実装」という流れでAIに渡せるので十分有効です。

AIでコード化したい場合は、要件の該当セクションと設計の該当セクションを抜き出し、順に提示しながら具体的なアウトプットを求める手順が最も安全です。追加で欲しいのが「テスト観点」や「サンプルデータの前提」などなら、既存ドキュメントに追記してからAIへ渡すと通しやすくなります。

Tips: 設計書の各モジュール記述に「入力・処理・出力」をワンセットで添えておくと、AIのプロンプトとして再利用しやすくなります。
</assistant>
<user>
AIに既存のアプリに追加する設計書を書きたいと思います。現在Next.jsとSupabaseのアプリは認証を書いて、ユーザーの登録まで設定済みです。DrizzleORMでデータベースのスキーマも最低限書いています。それを含めて指示書を書きたいです。どのように指示書を書くようにしじをしたらいいでしょうか？プロンプトを考えてもらえますか？
</user>
<assistant>
アクセス権限設計の既存文書を踏まえるなら、[0020 個別機能 大 -01要件定義書 -02設計書 -03テスト計画書/0012-02-アクセス権限設計書.md](0020 個別機能 大 -01要件定義書 -02設計書 -03テスト計画書/0012-02-アクセス権限設計書.md)を参照しつつ、以下のプロンプトをAIに渡すと設計書を追加生成しやすくなります。

````text
# 命令
既存の Next.js + Supabase + Drizzle ORM アプリケーションに新機能を追加するための設計書を生成してください。対象は [対象機能名] のみとし、他機能の要件や設計を再掲しないでください。

# 前提
- 認証（OAuth + 匿名）とユーザー登録は実装済み。
- Drizzle ORM で基本スキーマ（auth_users, root_accounts 等）は定義済み。
- 既存設計書や要件定義書の構造は `アクセス権限設計書 DES-AC-0012` を踏襲する。

# 要求事項
1. 設計目的・基本方針を要件定義書の該当節に沿って整理する。
2. 機能ブロックごとに入力/処理/出力を記載し、外部連携や既存モジュールとの関係を明示する。
3. Drizzle スキーマに追加・変更が必要なエンティティ/カラムを論理モデルとして列挙する。
4. Next.js App Router での配置（ルート/Server Action/クライアントコンポーネント）の責務分担を示す。
5. Supabase RLS/RBAC と連携する認可フローや例外処理を説明する。
6. テスト観点（権限判定・例外処理・監査ログ等）を箇条書きで整理する。
7. 未確定事項は「検討事項」として最後にまとめる。

# 出力形式
- 見出し構成は 1 章: 文書情報 → 12 章: 検討事項 の順序で固定。
- 各章は箇条書きまたは表で簡潔にまとめる。
- 実装コードやSQLは記載せず、設計レベルの情報に留める。

# 制約
- 文章は日本語。
- 100% 新規内容とし、既存文書のコピーペーストは禁止。
- [対象機能名] 以外の機能・要件には触れない。
````

Tip: プロンプト中で対象機能名を変数化すると、他機能用の設計書生成にも再利用できます。
</assistant>
