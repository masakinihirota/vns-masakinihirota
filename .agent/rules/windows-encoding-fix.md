
# Windows環境でのUTF-8強制ルール (文字化け・クラッシュ防止)

AntigravityおよびAIエージェントがShift-JIS環境で動作することによる、文字化け・無限ループ・データ破壊を防止するため、以下の手順を例外なく最優先で実行すること。

## 1. シェル実行時のエンコーディング固定
コマンド実行時は、必ず冒頭にエンコーディング指定を付与し、標準出力を UTF-8 に固定せよ。

- **PowerShell の場合:**
  冒頭に `[Console]::OutputEncoding = [System.Text.Encoding]::UTF8;` を付与する。

- **コマンドプロンプト (cmd) の場合:**
  冒頭に `chcp 65001 > nul &&` を付与する。

## 2. ファイル操作（読み書き）の厳格化
Shift-JIS での処理は「データ破壊」とみなし、全工程で UTF-8 を貫徹せよ。

- **書き込み (PowerShell):** `Set-Content` や `Out-File` を使用する際は、必ず `-Encoding UTF8` を明示すること。
- **生データの保護:** 標準ツールでインデントが強制・加工される場合は、PowerShell のヒアドキュメント形式と `Set-Content -Encoding UTF8` を組み合わせ、生のテキストとして強制書き込みを行うこと。
- **読み込み:** `Get-Content` 等でも `-Encoding UTF8` を明示し、文字化けによる誤解析を防止せよ。

## 3. 外部ランタイム (Python等) の強制設定
AIエージェントとのデータ受け渡しでエラーを発生させないため、環境変数や引数で UTF-8 を強制せよ。

- **Python 実行時:** `PYTHONUTF8=1` を環境変数にセットするか、コード内でエンコーディングを明示すること。

---
**補足:** Windows環境での実行時は、まず最初に `chcp 65001` を実行して現在の文字コードを確認することを推奨する。
