---
trigger: always_on
description: t-wada方式(RGRサイクル)に基づくテスト駆動開発(TDD)の実行手順と規約
---

# TDDワークフロー (TDD Workflow)

## 1. TDD実行手順（AIへの依頼）

必ずt-wada方式のテスト駆動開発で開発する

AIは、選択した**細分化タスク**を完了させるため、以下のRGRサイクルを順に実行すること。

### 1.1. テストファイル命名規則

| ファイル種別       | 命名規則                                         | 用途                                 |
| ------------------ | ------------------------------------------------ | ------------------------------------ |
| **View関連**       | `*.test.tsx`                                     | UIコンポーネントのテスト             |
| **ロジック/Fetch** | `*.logic.test.ts`, `*.logic.integration.test.ts` | ビジネスロジック、データ取得のテスト |

- テストファイルは、テストするコンポーネントやロジックと同じディレクトリに配置し、関連性を明確にします。

### 1.2. テスト記述規約

| 項目                     | ルール                                                                                               |
| ------------------------ | ---------------------------------------------------------------------------------------------------- |
| **テストフレームワーク** | Vitest + React Testing Library                                                                       |
| **テスト構造**           | `describe` でコンポーネント/関数名、`it` で具体的な振る舞い                                          |
| **言語**                 | テストケース名は日本語で記述し、仕様を明確にする                                                     |
| **アクセシビリティ**     | **重要**: UIコンポーネントのテストには `vitest-axe` によるチェック(`toHaveNoViolations`)を含めること |
| **パターン**             | AAA パターン（Arrange（準備）、Act（実行）、Assert（検証））を明確に分ける                           |

**例:**

```typescript
describe("ProfileList", () => {
  it("名前を表示する", () => {
    // Arrange
    const props = { name: "山田太郎", role: "エンジニア", bio: "開発者" };

    // Act
    render(<ProfileList {...props} />);

    // Assert
    expect(screen.getByText("山田太郎")).toBeInTheDocument();
  });
});
```

### 1.3. RGRサイクル

#### 🔴 ステップ1: テストコードの生成（REDフェーズ）

1. タスクの要件を満たすための**失敗するテストコード**を、該当する**テストファイル**（例: `[ComponentName].test.tsx`）に記述する。
2. テストを実行し、**失敗（RED）すること**を確認する。

#### 🟢 ステップ2: アプリケーションコードの生成（GREENフェーズ）

1. ステップ1で生成したテストを**すべて合格させる**ための**最小限のアプリケーションコード**を、対応するファイルに記述する。
2. テストを再度実行し、**すべてがグリーン（合格）**になることを確認する。

#### ✨ ステップ3: リファクタリング（REFACTORフェーズ）

1. テストがグリーンであることを前提に、生成したコードに対して**品質、可読性、効率**を高めるためのリファクタリングを提案・実行する。
2. リファクタリング後、**テストが引き続きグリーン**であることを最終確認し、**タスクを完了（チェック）**とする。
