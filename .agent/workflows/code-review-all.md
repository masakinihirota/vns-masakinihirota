---
description: src/components 以下の全コンポーネントディレクトリに対して、順次コードレビューを実行します。
---

# Code Review All Workflow

このワークフローは、`src/components` ディレクトリ内のすべてのコンポーネントに対して、個別に `code-review` ワークフロー（包括的なコードレビュー）を実行するためのメタワークフローです。

# 手順

1.  **コンポーネント一覧の取得**
    - `src/components` ディレクトリのスキャンを行い、直下のサブディレクトリ（コンポーネントカテゴリや個別コンポーネント）をリストアップしてください。
    - **差分モード (Optional)**: 変更があったコンポーネントのみを対象にする場合は、`git diff --name-only main...HEAD` 等で変更ファイルを特定し、該当する `src/components` 以下のディレクトリのみをリストアップしてください。
    - コマンド例: `Get-ChildItem src/components -Directory` (PowerShell)

2.  **各コンポーネントへの適用 (Iterative Execution)**
    - リストアップされた各ディレクトリに対して、以下の手順を**一つずつ**実行してください。
    - 一度にすべてを行おうとせず、1つのディレクトリが終わったら次へ進む形で着実に実行してください。

    ### 実行内容 (Per Component)
    1.  **対象ディレクトリの宣言**: 現在レビュー中のディレクトリ名を明示してください。
        - 例: `Reviewing component: src/components/ui`
    2.  **コードレビューの実行**:
        - 対象ディレクトリ内部に対して、以下のレビュー手順（`.agent/workflows/code-review.md` 準拠）を実行してください。
          - **機能性**: バグはないか？ 仕様通りか？
          - **セキュリティ**: 入力バリデーション、認証・認可、SQLインジェクション対策などは十分か？ (`code-review` スキル参照)
          - **パフォーマンス**: 無駄な再レンダリングやN+1問題はないか？
          - **可読性・保守性**: 命名規則、ディレクトリ構造、設計原則に従っているか？
          - **テスト**: 適切なテストファイルが存在し、網羅されているか？ (`test-workflow` スキル参照)

3.  **App層のチェック (Page Level Review)**
    - `src/app` ディレクトリ内の主要なページファイル（`page.tsx`, `layout.tsx`）をレビューします。
      - **責務分離**: ページコンポーネントが「表示と構成」のみに専念しているか？ データフェッチや複雑なロジックが混入していないか？
      - **設定漏れ**: `export const dynamic` や Metadata 設定が適切か？

4.  **横断的チェック (Cross-Cutting Concerns)**
    - 個別コンポーネントのレビューでは見落としがちな全体整合性を確認します。
      - **Barrel Export**: `index.ts` が存在し、適切に公開・隠蔽が行われているか？
      - **共通コンポーネント依存**: `src/components/ui` への依存が正しく、破壊的変更の影響を受けていないか？
      - **環境変数**: `.env` で定義されていない変数を参照していないか？

5.  **完了報告**
    - 全てのディレクトリのチェックが完了したら、検出された主な問題点（特にCritical/Majorなもの）のサマリーを報告してください。

# 注意点

- **時間配分**: コンポーネント数が多い場合、時間がかかります。適宜 `task_boundary` で進捗を報告してください。
- **発見重視**: このワークフローは修正ではなく「発見」を主目的とします。修正案は提示しますが、自動修正は慎重に行ってください。
