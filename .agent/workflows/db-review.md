---
description: DBアンチパターンチェックを実行する
---

# DB Review Workflow

このワークフローは `backend-engineering` スキルのデータベースベストプラクティスに基づき、DB設計やクエリのレビューを行います。

## 手順

1.  **コンテキスト読み込み**:
    - `.agent/skills/backend-engineering/SKILL.md` の「Postgres & Supabase Best Practices」セクションを確認します。

2.  **レビュー対象**:
    - `schema.sql`, `migrations/` 以下のSQLファイル
    - `src/` 以下のSupabaseクライアント使用箇所（データ取得・更新ロジック）

3.  **チェック項目**:
    - **RLS**: すべてのテーブルでRLSが有効か？ ポリシーは適切か？
    - **インデックス**: 検索条件や結合キーにインデックスが貼られているか？
    - **型安全性**: JSONBの乱用や、不適切な型キャストがないか？
    - **SQLインジェクション**: 文字列結合によるクエリ構築が行われていないか？
    - **N+1**: ループ内でのクエリ実行など、パフォーマンス上の問題がないか？

4.  **レポート**:
    - 問題点と改善案を提示します。必要な場合は修正用のSQLやコードスニペットを提供します。

## コマンド例

- `/db-review`: DB関連ファイルのレビュー
