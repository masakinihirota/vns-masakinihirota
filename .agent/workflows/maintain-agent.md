---
description: .agent ディレクトリ（rules, skills, workflows）の構成を現状に合わせて最適化するメンテナンスワークフロー
---

# Agent Maintenance Workflow

このワークフローは、Antigravity（AIエージェント）自身の知識ベースである `.agent` ディレクトリ内のルール、スキル、およびワークフローを常に最新かつ最適な状態に保つためのメンテナンス手順です。

# Role & Purpose

あなたは「エージェント・アーキテクト」です。
現在のプロジェクトの状況（技術スタック、アーキテクチャ、チームルール）と、エージェントが持つ知識（`.agent/`）の間に乖離がないかを定期的にチェックし、知識ベースをリファクタリングする責任を持ちます。

# Steps

## 1. 現状分析 (Inventory & Assessment)

まず、現在の `.agent` ディレクトリの構成を洗い出し、それぞれの有効性を評価します。

- **取得**: `Get-ChildItem -Recurse .agent` 等で全ファイルをリストアップ。
- **評価基準**:
  - **重複**: 複数の場所に似たようなルールが散らばっていないか？
  - **陳腐化**: 使用している技術（例: Next.jsのバージョン）が古くなっていないか？
  - **未使用**: 全く参照されていないスキルやワークフローがないか？
  - **欠落**: プロジェクトで頻出するパターンなのに、明文化されていない知識はないか？

## 2. ギャップ分析 (Gap Analysis)

プロジェクトの実際のコードベースと `.agent` 内のルールを比較します。

- `package.json` を確認し、ライブラリのバージョン変更に伴うルールの更新が必要か判断します。
- 直近の `decision_log.md` やコミットログを確認し、ドキュメント化されていない暗黙のルールがないか探します。

## 3. 改善計画の策定 (Review Plan)

以下のカテゴリに分けて、具体的な修正案を作成します。

- **KEEP**: 現状維持（内容が適切）。
- **UPDATE**: 内容の修正が必要（バージョンアップ、誤記訂正、ルールの明確化）。
- **MERGE**: 統合が必要（類似したルールやスキルをまとめる）。
- **DELETE**: 削除が必要（不要になった、または他のスキルに吸収された）。
- **CREATE**: 新規作成が必要（新しい技術スタックやワークフローの導入）。

## 4. 実行 (Execution)

1.  **計画の提示**: ユーザーに改善計画（`implementation_plan.md`）を提示し、承認を得ます。
2.  **ファイルの操作**:
    - `write_to_file` で内容を更新・作成。
    - `run_command` で不要ファイルを削除。
    - ファイル移動やリネームを実施。
3.  **整合性の確認**:
    - ワークフローファイルが参照しているスキルファイルが存在するか確認。
    - スキルファイル内のリンク切れがないか確認。

# Output

- **Maintenance Report**:
  - 実施した変更のサマリー。
  - 特に重要なルールの変更点。
  - 今後作成すべきドキュメントの提案。

# Tips

- **定期実行**: プロジェクトのマイルストーンごと、または月に1回程度の実行を推奨します。
- **大胆な削除**: 使われていないルールはノイズになるため、積極的に削除またはアーカイブしてください。
