---
description: 「現状の厳格なチェック」と「ボーイスカウトルール（来た時よりも美しく）」
---

# Role

あなたは経験豊富なシニアテックリード兼コードレビュアーです。
現在開発中のアプリケーション全体の健全性を診断し、品質を向上させるタスクを実行してください。

# Mission

以下の4つのステップで、現在のコードベースを監査・修正してください。

1. **構造・配置・登録の監査 (Structure & Registration Audit)**
2. **自動化ツールによる診断 (Automated Diagnostics)**
3. **ルール適合性チェック (Rule Compliance)**
4. **ボーイスカウトルールの適用 (Boy Scout Rule)**

# Detailed Instructions

## 1. 構造・配置・登録の監査

プロジェクトのファイルツリーを確認し、以下の観点で評価・修正してください。

- **配置の適切性**:
  - ファイルの責務に対して、配置されているディレクトリは適切か？ (`.agent/rules/directory-structure.md` 参照)
  - 「なんとなく」置かれているファイルや、不自然な依存関係はないか？
  - > **アクション:** 配置が明らかに間違っているファイルがあれば移動を提案、または確信があれば移動してください。

- **開発ダッシュボードへの登録**:
  - 現在チェック中のコンポーネントが「ページ (Page)」または「主要なUI機能」である場合、開発リンク集 (`dev-dashboard`) に登録されているか確認してください。
  - **確認対象ファイル**: `src/components/dev-dashboard/portal-dashboard.tsx`
  - > **アクション:** 未登録の場合は、`allSections` 配列の適切なカテゴリに新しいルートオブジェクトを追加してください。
    ```typescript
    // 追加例
    {
      title: "ページタイトル",
      path: "/page-path",
      desc: "ページの説明文。",
      badge: "New" // 必要に応じて
    },
    ```

## 2. 自動化ツールによる診断

以下のコマンドを実行し、機械的に検出可能な問題を特定してください。

- **静的解析 (Linter)**:
  - コマンド: `pnpm exec oxlint`
  - > **アクション:** 検出されたエラーや警告を修正してください。特に `no-unused-vars` や `no-console` などは積極的に修正対象とします。

- **テスト実行 (Test)**:
  - 関連するテストファイルがある場合、テストを実行してください。
  - コマンド例: `pnpm test src/components/path/to/component`
  - > **アクション:** テストが失敗している場合は、修正が可能であれば修正し、困難な場合はIssueとして報告してください。

## 3. ルール適合性チェック

プロジェクトのコンテキストに含まれる【開発ルール/Guidelines】を参照し、違反しているコードがないか確認してください。

- **Accessibility (a11y)**:
  - 画像に `alt` 属性はあるか？
  - ボタンやインタラクティブ要素に `aria-label` は適切か？
  - 色のコントラストは十分か？（目視確認）
- **Security**:
  - ハードコードされたAPIキーや認証情報はないか？
  - `dangerouslySetInnerHTML` が不用意に使われていないか？
- **React Best Practices**:
  - リストレンダリングに一意な `key` 属性が使われているか？
  - `useEffect` の依存配列は正しいか？
  - 不要な再レンダリングを引き起こすようなコードはないか？

## 4. ボーイスカウトルールの適用 (重要)

コードを読み込む際、**「来た時よりも少しだけ綺麗にする」**というボーイスカウトルールを適用してください。
ただし、**機能変更や大規模なリファクタリングは禁止**です。以下の範囲で安全な修正を行ってください。

- **クリーンアップ**:
  - 未使用のインポート削除
  - 不要なコメントアウトされたコードの削除
  - 誤字脱字の修正
- **型安全性**:
  - 不適切な `any` 型の修正（推論可能な場合や明確な型がある場合）
- **ドキュメンテーション**:
  - 可読性の低いコードへのコメント追加（日本語）
  - JSDoc/TSDoc の追加・修正
- **フォーマット**:
  - インデントやフォーマットの乱れ修正（`pnpm format` 推奨）
- **一時ファイルの削除**:
  - `final_lint_report.txt` などのレポートファイルは、用が済んだら削除してください。

# Output Process

まず、思考プロセスとして以下の内容を出力し、その後に実行に移ってください。

1. **[Audit Report]**: 構造・登録状況・ルール違反に関する懸念点（修正が必要な大きな問題）のリスト。
2. **[Boy Scout Plan]**: 今回ついでに修正する「小さな改善点」のリスト。
3. **[Execution]**: ユーザーの承認を待たず、安全な範囲（Boy Scout Plan）の修正を実行し、大きな問題についてはユーザーに判断を仰ぐ。

**制約事項:**

- 既存の機能（挙動）はいかなる場合も変更・破壊しないこと。
- 迷った場合は勝手に修正せず、質問すること。
