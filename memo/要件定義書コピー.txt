
目次

# 全体要件定義書

## 1. 目的・コンセプト

概要

---

機能要件
優先度: 高、中、小

## 優先度:大

0012-アクセス権限
0014-RBAC グループと役割
0020-データベース設計
0022-役割
0024-RBAC マトリクス図
0026-テーブル定義書
0050-URL
0054-画面UI
0056-API設計書
0100-ルートアカウント
0110-ユーザープロフィール
0200-非機能要件
0202-セキュリティ設計書
0300-作品登録
0310-カテゴリとジャンル
0312-価値観のカテゴリ
0314-価値観登録
0320-タグ
0400-グループ関連
0500-評価
0510-スキル登録
0520-リスト
0600-マッチング
0610-自動マッチング
0620-手動マッチング
0700-メニュー

## 優先度:中

0710-通知
0720-検索、履歴
0800-チェーン
0810-マンダラチャート
0900-管理機能
1000-国際化
1002-国際化多言語対応設計書
1002-国際化多言語対応テスト計画書

## 優先度:小

1010-スマホ対応
1100-コメント
1110-見守り
1120-ペナルティ
1200-レコメンド
1210-チュートリアル
1400-広告関連
1410-サブスク

----------------------------------------

## 1. 目的・コンセプト

概要

VNSのmasakinihirotaというWebサービスを作ります。
価値観でつながるVNS（Value Network Service）を作成します。
個人情報は極力控えて、個人の価値観ベースでマッチングする

MVPは、最小限の登録と体験で、価値検証とユーザーフィードバック取得を目的とする。


「masakinihirotaは、インターネットという情報の洪水の中から真っ先に価値のあるものを拾い上げるサービスです。」

個人情報は極力控えてて
価値観でつながるマッチングサイト

オンライン上の名刺を目指します。













----------------------------------------

個別機能説明パート

## 優先度:大

### 認証前

Supabaseのを活用

匿名認証	ゲストで対応

OAuth		新規ユーザーで対応
	Google
	GitHub

### 認証終了後

	初期設定モーダル（全リセット時のみ再設定可）
		地球3分割（1/2/3）/ 母語（複数）/ UI言語（ja/en）/ 生誕世代（around）/ オアシス宣誓（必須）/ 広告ON/OFF。
	完了後にルートアカウント作成（冪等upsert）。

	初回ボーナスあり
		初期ポイント3000(通常1000)
		信頼経過日数は30(通常0)

	リセットはいつでも初期状態に戻れる
	リスクなし(初回ボーナス無し)
	初期ポイント1000
	信頼経過日数0
	評価リセット
	警告リセット
	イエローカードリセット
	レッドカードリセット
	一度もアクセスがないとリセット


### 0012-アクセス権限

* ユーザー
	ゲスト/新規ユーザー	未登録、まだユーザープロフィールを作ってない者
	リーダー	グループのリーダー
	メンバー	グループのメンバー
	スポンサー	スポンサー用

* 開発
	管理人		Webアプリ運用時の権限
	テスター	テスター用
	開発		開発時における全アクセス権限、セキュリティ管理者
	経理		経理関連の責任者



### 0014-RBAC グループと役割

* グループ
	Group or Home (自分の家=家族用)	10
	Neighborhood (ネイバーフッド) 近所	10
	Village (ヴィレッジ)村	10
	Town (タウン)	町	10
	City (シティ)	市	10
	Metropolis(メトロポリス) 都 / 大都市圏	10
	State (ステート)		州	10
	Country(カントリー) Nation (ネイション) 国 Kingdom 王国	10
	Continent (コンティネント)	大陸	10
	Alliance 連合、連盟 (複数大陸)	10
	Hemispheres (半球)	10
	an earth ある一つの惑星	1億



### 0020-データベース設計

RBACを使う

Webアプリで必要なテーブルを作る
トリガーを使用するかどうか考える

### 0022-役割

	ゲスト/新規ユーザー
	リーダー
	メンバー
	スポンサー



### 0024-RBAC マトリクス図

### 0026-テーブル定義書

各テーブルを定義する



### 0050-URL

URL設計書を読む



### 0054-画面UI

設計書よりAIにUIを考えてもらう



### 0056-API設計書



### 0100-ルートアカウント
	1ユーザー=1ルート（UUID v4）。
	リセット（認証以外の全データ初期化、2段階確認）。
	ポイント表示のみ（消費/回復ロジックは未実装）。
	経過日数=作成日からの単純差分（カード運用なし）。

### 0110-ユーザープロフィール
	複数作成可（上限4、目的の重複不可: work/friend/marriage(1件のみ)/end_of_life/other）。
	項目: 名前（匿名可）、最新の状態（status: standby/open/exploring/closed）。
	作成時に自動で「自分のグループ」を生成し自分がリーダー。
	名刺/履歴書/フルの表示切替（データ構造共通）。
	既存作品から選択し tense(now/future/life) + tier(tier1/2/3/normal/not_for_me) を付与。
	登録済み価値観の選択肢を回答として付与。プロフィール間コピーは次フェーズ。

### 0200-非機能要件
	パフォーマンス: 主要API/SSRのP90 200ms以内（サーバー内計測、DBネットワーク除く）。
	セキュリティ: OAuth, RLS, 入力バリデーション（Zod）、XSS対策。
	信頼性: 99.9%目標（SaaS依存、Supabase標準バックアップ）。
	拡張性: モジュール化、スキーマ整備。
	ユーザビリティ: シンプルUI、A11y配慮、レスポンシブ、ネタバレ防止配慮。
	互換性: モダンブラウザ最新。
	テスト: statements>=80%, branches>=70%（暫定）。
	ログ最小: sign-in, onboarding complete, profile create, match compute（回数）。

### 0202-セキュリティ設計書

### 0300-作品登録

### 0310-カテゴリとジャンル

### 0312-価値観のカテゴリ

### 0314-価値観登録
	公式作品（~100件）は管理者シード。ユーザーは追加登録可（自身/将来はグループ限定可）。
	ユーザー登録作品はTier1-3のみ対象（normal/not_for_meは不可）。
	カテゴリ: anime | manga（MVP）。
	価値観は設問/選択肢モデル（label/option_text）。回答保存は profile_value_answers。is_importantを持つ。
	i18n列は後続。MVPは単一言語列。

### 0320-タグ

### 0400-グループ関連
	ルール: オアシス宣言のみ自動適用。
	関係語彙: watch/follow/friend/pre_partner/partner（MVPはwatch候補保存のみ）。

### 0500-評価

### 0510-スキル登録

### 0520-リスト

### 0600-マッチング
	マッチングでスコア/ランクが表示される。
	価値観/作品を元に暫定スコア（0-100）を算出しランク表示（High/Medium/Low/Very Low）。
	素点構成例（抜粋）: 作品tier一致/不一致、価値観一致、重要フラグ加点、偏りペナルティ等。
	自動マッチング（候補保存）: デフォルト score>=75 を最大5人（MVPはローカル候補保存のみ）。
	手動マッチング: 候補一覧→選択→グループ追加（取消は次フェーズ）。

### 0610-自動マッチング

### 0620-手動マッチング

### 0700-メニュー





### ## 優先度:中

### 0710-通知

### 0720-検索、履歴

### 0800-チェーン

### 0810-マンダラチャート

### 0900-管理機能

### 1000-国際化
	言語切替: ja/en。
	ナビ: Header(Home/lang/dark/auth)、Side(ルート### /プロフィール/登録/マッチ)。
	非対応機能は「???」プレースホルダ。

### 1002-国際化多言語対応設計書

### 1002-国際化多言語対応テスト計画書





### ## 優先度:小

### 1010-スマホ対応

### 1100-コメント

### 1110-見守り

### 1120-ペナルティ

### 1200-レコメンド

### 1210-チュートリアル

### 1400-広告関連

### 1410-サブスク



