
条件1つだけ
	オアシス宣言のグループ
	オアシス宣言では無いグループ

最小単位
	ユーザーが作成するグループは階層構造の一番下のグループ/ホーム（Group/Home）レベル1のみ

グループマッチング
	マッチングはすべてグルー府単位で行う



これはユーザープロフィールを元に
自動でグループを作成する
最初はリーダーの自分一人
それで手動マッチングして
価値観の近い人をウォッチするかフォローするかを選ぶ



申請型自動グループ

公式がある程度のグループを用意する＜＜自動マッチング
頻度が高い条件のグループを公式が調査をして、
修正しつつグループを拡大していく
その条件に合う人が自動で集まる
自動で参加してくるし、自動で外れる



ユーザーがセミオーダーのグループを申請する＜＜半自動マッチング、セミオートマッチング
必須の条件、譲れない条件でグループを作る
その条件に合う人が自動で集まる
選ぶことはできない
自動で参加してくるし、自動で外れる



ユーザーが0からグループを作る＜＜手動マッチング
ユーザープロフィールの価値観のマッチングの後に、ユーザーが自分でグループを作る
自分で作ったグループに人を集める
完全に選ぶことが出来る




----------------------------------------
----------------------------------------

グループアイデアメモ

## 基本方針

- **事前グループ作成**: ユーザーごとにグループを作ると無限になるため、全ユーザーの条件を分析して頻度が高いグループを事前に作成
- **自動振り分け**: 作成済みグループに条件一致でユーザーを自動参加
- **手動参加**: ユーザーが任意に参加申請・招待

----------------------------------------

# 自動マッチング

## 基本コンセプト

条件が少ないほど人が集まりやすい。
条件を増やすほど、マッチング精度は上がるが参加者は減る。

## 事前グループ作成の仕組み

### 1. 全ユーザー条件の集計・分析

定期的（例: 日次バッチ）に以下を実行:

```
1. 全ユーザーのプロフィール条件を集計
2. 条件の組み合わせで頻度分析
3. 閾値以上の条件組み合わせを抽出
4. 対応するグループを自動生成
```

### 2. グループ生成条件の優先度

**高頻度条件で優先的にグループ作成:**

| 優先度 | 条件 | 例 |
|--------|------|-----|
| 🔴 高 | 信頼継続日数帯 | 100日以上、365日以上 |
| 🔴 高 | 重要な価値観の一致数 | 1つ以上一致、3つ以上一致、5つ以上一致 |
| 🟡 中 | オアシス宣言のカテゴリ | 環境保護、教育支援、地域貢献 |
| 🟡 中 | 好きな作品ジャンル | アニメ、漫画 |
| 🟢 低 | 特定スキル | プログラミング、デザイン、語学 |

### 3. グループ生成アルゴリズム

```
For each 条件組み合わせ:
  該当ユーザー数 = COUNT(条件一致ユーザー)

  If 該当ユーザー数 >= 最小人数閾値 (例: 10人):
    グループを生成
    グループ名 = 条件から自動生成
    グループ説明 = テンプレートから自動生成
    該当ユーザーに参加候補通知
```

### 4. 条件組み合わせ例

**Tier 1: 汎用グループ（多人数想定）**
- 信頼継続日数 30日以上
- 信頼継続日数 100日以上
- 価値観 3つ以上一致

**Tier 2: 特化グループ（中人数想定）**
- 信頼継続日数 100日以上 ＋ 環境保護に興味
- 価値観 5つ以上一致 ＋ アニメ好き
- プログラミングスキル ＋ 教育支援に興味

**Tier 3: ニッチグループ（少人数想定）**
- 信頼継続日数 365日以上 ＋ 価値観 5つ以上一致 ＋ 特定作品好き

## 自動マッチング条件

どの条件を使うかは、グループタイプやリーダーの設定次第:

- ✅ **信頼継続日数**: 継続性の指標
- ✅ **重要な価値観の一致**: 価値観の共有度
- ✅ **オアシス宣言**: 活動分野の一致
- ⚠️ **好きな作品**: 趣味の一致（補助的）
- ⚠️ **好きなリスト/登録リスト**: 興味の一致（補助的）
- ⚠️ **スキル**: 能力マッチング（特化グループ向け）

## 人数によって呼び名が変わる

階層に達するには規定の人数以上になると自動で呼び名が変わる:

| 人数 | 呼び名 | 説明 |
|------|--------|------|
| 2-4人 | **つながり** | 少人数の繋がり |
| 5-9人 | **サークル** | 小規模コミュニティ |
| 10-29人 | **グループ** | 中規模コミュニティ |
| 30-99人 | **コミュニティ** | 大規模コミュニティ |
| 100-299人 | **連合** | 複数コミュニティの集合 |
| 300人以上 | **ムーブメント** | 大規模な運動体 |

## 自動マッチングのタイミングにはポイントが必要

**マッチング実行コスト:**
- 初回マッチング: 無料
- 2回目以降: ポイント消費（例: 10ポイント/回）
- 頻度制限: 週1回まで無料、追加はポイント制

**理由:**
- スパム的な頻繁マッチングを防止
- グループの安定性を保つ
- 慎重なグループ選択を促す

## グループ自動更新

**定期メンテナンス:**
```
毎日 深夜2時実行:
1. 新規ユーザーのマッチング候補検索
2. 条件変更ユーザーの再マッチング
3. 新規グループの自動生成判定
4. 休眠グループの統合・アーカイブ
```

**グループライフサイクル:**
- 30日間活動なし → **休眠グループ**
- 90日間活動なし → **アーカイブ候補**
- 類似休眠グループ → **統合提案**







----------------------------------------

# 手動マッチング

## 基本コンセプト

自動マッチングでは見つからない、個別の繋がりを作る仕組み。

## ウォッチ（観察）

**概要:**
- 特定のユーザーやグループの活動を観察
- 通知は受け取るが、相手には通知されない（一方向）
- お試し期間として機能

**機能:**
- グループの投稿・活動が自分のフィードに表示
- ウォッチ解除も自由

**用途:**
- 興味があるグループを試しに観察
- 参加前の雰囲気確認
- 複数グループの比較検討

## フォロー（関係構築）

**概要:**
- 特定のユーザーとの繋がりを作る
- 相互フォローでより深い関係に

**機能:**
- フォロー通知が相手に送信
- フォロー中ユーザーの活動優先表示
- 相互フォロー → DM可能に

**用途:**
- 気になるユーザーとの関係構築
- 価値観の近い人との繋がり
- メンター・メンティー関係

## 招待（直接参加）

**概要:**
- 既存メンバーが新規ユーザーを直接招待
- 招待コード生成で特定ユーザーのみ参加可能

**機能:**
- 招待リンク生成（有効期限設定可能）
- 招待承認制 or 自動承認
- 招待者に紹介ボーナスポイント

**用途:**
- 友人・知人の招待
- オフライン活動からのオンライン展開
- 信頼できるメンバーの増員

## 申請（参加リクエスト）

**概要:**
- ユーザーから特定グループへの参加申請
- 承認制グループへの門戸

**機能:**
- 申請メッセージ（自己紹介・参加理由）
- 管理者・リーダーによる承認/却下
- 申請履歴の記録

**用途:**
- クローズドグループへの参加
- 質の高いコミュニティ形成
- スパム防止

## 検索（グループ発見）

**概要:**
- キーワード・条件でグループを検索
- フィルタリングで最適なグループを発見

**検索条件:**
- キーワード（グループ名、説明、タグ）
- カテゴリ（オアシス宣言の分野）
- 人数帯（少人数 / 中規模 / 大規模）
- 活動頻度（毎日 / 週次 / 月次）
- 公開設定（公開 / 限定公開 / 非公開）

**表示順:**
- おすすめ（マッチング精度順）
- 新着順
- 人気順（参加者数順）
- 活発順（投稿数順）

----------------------------------------

# グループ作成

## リーダーによる手動作成

**作成権限:**
- 信頼継続日数 30日以上のユーザー
- または特定の実績達成者

**作成手順:**
1. グループ名・説明の入力
2. カテゴリ・タグの設定
3. 公開設定（公開 / 限定公開 / 非公開）
4. 自動マッチング条件の設定（任意）
5. 初期メンバーの招待（任意）

**制約:**
- 1ユーザーあたり同時管理グループ数上限（例: 5個）
- グループ作成にポイント消費（例: 50ポイント）

## システムによる自動作成

**作成条件:**
- 全ユーザー分析で特定条件組み合わせの需要が閾値超過
- 該当ユーザー数が最小人数（例: 10人）以上
- 類似グループが存在しない

**自動作成プロセス:**
```
1. 日次バッチで需要分析
2. 新規グループ候補の抽出
3. グループ名・説明の自動生成（AI活用）
4. 該当ユーザーへの参加候補通知
5. 一定期間内に参加者が集まれば正式化
6. 集まらなければ候補削除
```

**自動生成グループの特徴:**
- 初期リーダーはシステムまたは立候補制
- テンプレートベースの説明文
- 段階的な成長を前提とした設計

----------------------------------------

# グループの種類

## 公開グループ

**特徴:**
- 誰でも検索・閲覧可能
- 参加は自由または承認制
- グループ内の投稿は公開

**用途:**
- オープンなコミュニティ
- 知識共有・情報交換
- 大規模なムーブメント形成

## 限定公開グループ

**特徴:**
- メンバーのみ投稿閲覧可能
- 検索で存在は確認できる
- 参加は承認制

**用途:**
- 特定テーマの専門コミュニティ
- 質の高い議論の場
- セミクローズドな活動

## 非公開グループ

**特徴:**
- 招待制のみ参加可能
- 検索結果に非表示
- 存在自体が限定的

**用途:**
- 友人・知人のみのグループ
- プライベートな活動
- 慎重な議論が必要な場

## 自動グループ vs 手動グループ

| 項目 | 自動グループ | 手動グループ |
|------|-------------|-------------|
| 作成者 | システム | ユーザー（リーダー） |
| 条件設定 | 事前定義された条件 | リーダーがカスタマイズ |
| メンバー募集 | 自動マッチング | 招待・申請 |
| 柔軟性 | 低 | 高 |
| 立ち上げコスト | なし | ポイント消費 |
| 管理負担 | 低（自動化） | 高（手動管理） |
| 用途 | 大規模・汎用的 | 特化・カスタム |

----------------------------------------

# グループ統計・分析

## リアルタイム集計

**ダッシュボード表示項目:**
- 総グループ数
- 総メンバー数
- 平均グループサイズ
- 日次新規グループ数
- 日次参加・離脱数

## 条件別分析

**定期レポート（週次/月次）:**
```
条件組み合わせ別:
- 各条件での該当ユーザー数
- 頻度ランキング Top 20
- 新規出現条件組み合わせ
- 減少傾向の条件組み合わせ
```

**アクション:**
- 高需要条件 → 新規グループ自動生成
- 低需要条件 → 類似グループ統合提案
- トレンド条件 → 運営側で特集企画

## グループ健全性指標

**アクティブグループの定義:**
- 7日以内に1回以上の投稿
- 30日以内に3人以上の投稿者
- メンバー離脱率 < 20%/月

**休眠グループの対応:**
```
30日間投稿なし:
→ リーダーに活性化提案通知

60日間投稿なし:
→ メンバーに他グループ推薦

90日間投稿なし:
→ アーカイブ化（検索非表示、データは保持）
```

----------------------------------------

# 実装における技術的考慮

## データベース設計

**主要テーブル:**
```
groups (グループマスタ)
- id
- name
- description
- type (auto/manual)
- visibility (public/limited/private)
- created_at
- archived_at

group_members (メンバーシップ)
- group_id
- user_id
- role (leader/moderator/member)
- joined_at
- status (active/left)

group_conditions (グループ条件)
- group_id
- condition_type (trust_days/values/declaration/skill等)
- condition_value
- priority

user_group_matches (マッチング候補)
- user_id
- group_id
- match_score
- notified_at
- responded_at
```

## バッチ処理設計

**日次バッチ (深夜2:00実行):**
```python
def daily_group_maintenance():
    # 1. 全ユーザー条件集計
    user_conditions = aggregate_user_conditions()

    # 2. 条件組み合わせ頻度分析
    condition_frequencies = analyze_condition_combinations(user_conditions)

    # 3. 新規グループ候補抽出
    new_group_candidates = extract_high_demand_groups(
        condition_frequencies,
        threshold=10  # 最小10人
    )

    # 4. グループ自動生成
    for candidate in new_group_candidates:
        if not exists_similar_group(candidate):
            create_auto_group(candidate)
            notify_matching_users(candidate)

    # 5. 休眠グループ検出・対応
    dormant_groups = find_dormant_groups(days=30)
    for group in dormant_groups:
        handle_dormant_group(group)

    # 6. マッチングスコア更新
    update_all_matching_scores()
```

## パフォーマンス最適化

**インデックス設計:**
```sql
-- 条件検索用
CREATE INDEX idx_group_conditions_type_value
ON group_conditions(condition_type, condition_value);

-- マッチング検索用
CREATE INDEX idx_user_group_matches_score
ON user_group_matches(user_id, match_score DESC);

-- アクティブグループ検索用
CREATE INDEX idx_groups_active
ON groups(archived_at)
WHERE archived_at IS NULL;
```

**キャッシュ戦略:**
- グループリスト: Redis (TTL 5分)
- マッチング候補: Redis (TTL 1時間)
- 統計データ: Redis (TTL 1日)

## セキュリティ考慮

**アクセス制御:**
- 公開グループ: 誰でも閲覧可能
- 限定公開グループ: メンバーのみ閲覧可能（RLS適用）
- 非公開グループ: 招待者リストでのアクセス制限

**スパム対策:**
- グループ作成: レート制限（1日3回まで）
- 参加申請: レート制限（1日10回まで）
- 招待送信: レート制限（1日20件まで）

----------------------------------------

# 今後の拡張案

## AI活用

- グループ名・説明文の自動生成
- メンバー推薦の精度向上（機械学習）
- トレンド予測（今後需要が高まる条件）
- 自動モデレーション（不適切投稿検知）

## ゲーミフィケーション

- グループ貢献度バッジ
- アクティブメンバーランキング
- グループ成長マイルストーン
- コラボレーション実績

## クロスグループ機能

- 複数グループ横断検索
- グループ間コラボイベント
- グループ連合形成
- 共通興味グループの自動提案

----------------------------------------

# 運用フロー例

## ユーザー視点のグループ参加フロー

### パターンA: 自動マッチング経由

```
1. ユーザー登録・プロフィール入力
   ↓
2. システムが条件分析
   ↓
3. マッチング候補グループ通知（3-5件）
   ↓
4. ユーザーがグループを選択
   ↓
5. 自動参加 or 承認待ち
   ↓
6. グループ活動開始
```

### パターンB: 手動検索経由

```
1. グループ検索画面
   ↓
2. キーワード・条件で絞り込み
   ↓
3. 気になるグループをウォッチ
   ↓
4. 数日間観察
   ↓
5. 参加申請またはフォロー
   ↓
6. 承認後、グループ活動開始
```

### パターンC: 招待経由

```
1. 友人・知人から招待リンク受信
   ↓
2. リンクをクリック
   ↓
3. グループ詳細確認
   ↓
4. 参加ボタンクリック
   ↓
5. 即座にグループ参加
```

## システム視点の自動グループ生成フロー

### フェーズ1: データ収集（継続的）

```
全ユーザーのプロフィール変更を監視
  ↓
条件データを蓄積
  ↓
日次で集計テーブル更新
```

### フェーズ2: 分析（日次バッチ）

```
条件組み合わせの頻度分析
  ↓
閾値（例: 10人以上）を超える組み合わせ抽出
  ↓
既存グループとの重複チェック
  ↓
新規グループ候補リスト作成
```

### フェーズ3: グループ生成（日次バッチ）

```
For each 候補:
  グループ名自動生成（テンプレート or AI）
  ↓
  グループ説明文自動生成
  ↓
  該当ユーザーリスト作成
  ↓
  仮グループ作成（draft状態）
  ↓
  該当ユーザーに通知送信
```

### フェーズ4: 正式化判定（7日後）

```
通知から7日経過時点で判定:

  参加表明 >= 5人:
    → グループ正式化
    → リーダー選出（立候補 or 抽選）
    → 活動開始

  参加表明 < 5人:
    → グループ候補削除
    → データは分析用に保持
```

----------------------------------------

# FAQ

## Q1: 自動グループと手動グループ、どちらがおすすめ？

**A:**
- **初心者・気軽に始めたい**: 自動グループ推奨（条件マッチで簡単参加）
- **特定テーマで活動したい**: 手動グループ推奨（カスタマイズ性が高い）
- **両方参加も可能**: 自動で広く繋がり、手動で深い関係構築

## Q2: グループに参加できる数に制限はある？

**A:**
- 同時参加上限: 20グループ
- ウォッチ上限: 50グループ
- 理由: フィード混雑防止、質の高い関与促進

## Q3: グループが活発でない場合は？

**A:**
1. 他の類似グループを検索・ウォッチ
2. 自分から投稿・議論を始める
3. 新規メンバー招待を提案
4. 最終手段として離脱、他グループへ移動

## Q4: グループの条件変更は可能？

**A:**
- **自動グループ**: 条件変更不可（システム定義）
- **手動グループ**: リーダーが変更可能
  - ただし大幅変更は既存メンバーへ通知・確認
  - 反対多数の場合は変更保留

## Q5: グループ作成に必要な条件は？

**A:**
- 信頼継続日数 30日以上
- ポイント 50ポイント消費
- 同時管理グループ数 5個以内
- 過去のグループ管理実績（違反なし）

## Q6: 自動生成グループのリーダーは誰？

**A:**
1. グループ正式化時に立候補募集（7日間）
2. 立候補者がいる場合 → 投票または先着
3. 立候補者がいない場合 → システムが初期メンバーから抽選
4. リーダー不在期間が長い場合 → 自動的に副リーダーに権限委譲

## Q7: グループを削除したい場合は？

**A:**
- **リーダーの場合**:
  - 全メンバーへ事前通知（14日前）
  - 代替グループ提案
  - 承認後、削除実行
- **メンバーの場合**:
  - 自由に離脱可能
  - 投稿データは匿名化

## Q8: プライベートな会話はできる？

**A:**
- グループ内投稿: 全メンバーが閲覧可能
- 個別DM: 相互フォロー関係があれば可能
- サブグループ: 特定メンバーのみの小規模グループ作成可能

----------------------------------------

# まとめ

## 自動マッチングの強み

✅ 簡単にグループ参加できる
✅ 条件に合った人と自動で繋がる
✅ 新規ユーザーでもすぐにコミュニティに馴染める
✅ システムが最適なグループを提案
✅ 大規模な繋がりを形成しやすい

## 手動マッチングの強み

✅ 特定の人・グループと意図的に繋がれる
✅ 細かい条件でグループを探せる
✅ 自分でコミュニティを作り上げられる
✅ より深い関係性を築ける
✅ ニッチな興味・価値観でも繋がれる

## ハイブリッド戦略

**推奨アプローチ:**

```
初期段階（登録後1-2週間）:
→ 自動マッチングで広く繋がる
→ 複数グループをウォッチして雰囲気確認

成長段階（2週間-3ヶ月）:
→ 活発なグループに注力
→ 手動検索で興味特化グループ探索
→ 既存メンバーとフォロー関係構築

定着段階（3ヶ月以降）:
→ コアグループ2-3個に集中
→ 自分でグループ作成を検討
→ リーダーシップ発揮
→ 招待で信頼できる人を増やす
```

## 成功指標（KPI）

**システム全体:**
- アクティブグループ率: 80%以上
- 平均グループ参加数: 5個/ユーザー
- 新規ユーザー1週間以内グループ参加率: 90%以上
- 自動グループ正式化率: 60%以上

**個別ユーザー:**
- 月間投稿数: 3回以上
- 相互フォロー関係: 5人以上
- グループ貢献度スコア: 継続的な向上

## 重要な設計思想

### 1. スケーラビリティ優先

「ユーザーごとにグループを作ると無限になる」問題への対処:
- ✅ 事前に人気条件でグループを作成
- ✅ ユーザーは既存グループに振り分け
- ✅ 定期的な需要分析で動的に調整

### 2. ユーザー体験の段階設計

```
入口: 自動マッチング（低負担・簡単）
  ↓
中間: ウォッチ・検索（能動的探索）
  ↓
深化: グループ作成・リーダーシップ（コミットメント）
```

### 3. システムの自己進化

- 日次バッチでトレンド自動把握
- 需要に応じた自動グループ生成
- 休眠グループの自動統合・アーカイブ
- 運営負荷を最小化しつつ最適化

----------------------------------------
----------------------------------------


